

clc
clear
m_1=0;  
m_2=0;    
m_3=0;  
m_4=0;  
m_5=0;  
m_6=0; 
m_7=0;  
m_8=0;  
m_9=0;
m_10=0;
m_11=0;  
m_12=0;    
m_13=0;  
m_14=0;  
m_15=0;  
m_16=0; 
m_17=0;  
m_18=0;  
m_19=0;
m_20=0;
All_data_Results_1 = cell(1,40);
All_data_Results_2 = cell(1,40);
All_data_Results_3 = cell(1,40);
All_data_Results_4 = cell(1,40);
All_data_Results_5 = cell(1,40);
All_data_Results_6 = cell(1,40);
All_data_Results_7 = cell(1,40);
All_data_Results_8 = cell(1,40);
All_data_Results_9 = cell(1,40);
All_data_Results_10 = cell(1,40);
All_data_Results_11 = cell(1,40);
All_data_Results_12 = cell(1,40);
All_data_Results_13 = cell(1,40);
All_data_Results_14 = cell(1,40);
All_data_Results_15 = cell(1,40);
All_data_Results_16 = cell(1,40);
All_data_Results_17 = cell(1,40);
All_data_Results_18 = cell(1,40);
All_data_Results_19 = cell(1,40);
All_data_Results_20 = cell(1,40);

m_1_1=0;  
m_1_2=0;    
m_1_3=0;  
m_1_4=0;  
m_1_5=0;  
m_1_6=0; 
m_1_7=0;  
m_1_8=0;  
m_1_9=0;
m_1_10=0;
m_1_11=0;  
m_1_12=0;    
m_1_13=0;  
m_1_14=0;  
m_1_15=0;  
m_1_16=0; 
m_1_17=0;  
m_1_18=0;  
m_1_19=0;
m_1_20=0;
All_data_Results_1_1 = cell(1,40);
All_data_Results_1_2 = cell(1,40);
All_data_Results_1_3 = cell(1,40);
All_data_Results_1_4 = cell(1,40);
All_data_Results_1_5 = cell(1,40);
All_data_Results_1_6 = cell(1,40);
All_data_Results_1_7 = cell(1,40);
All_data_Results_1_8 = cell(1,40);
All_data_Results_1_9 = cell(1,40);
All_data_Results_1_10 = cell(1,40);
All_data_Results_1_11 = cell(1,40);
All_data_Results_1_12 = cell(1,40);
All_data_Results_1_13 = cell(1,40);
All_data_Results_1_14 = cell(1,40);
All_data_Results_1_15 = cell(1,40);
All_data_Results_1_16 = cell(1,40);
All_data_Results_1_17 = cell(1,40);
All_data_Results_1_18 = cell(1,40);
All_data_Results_1_19 = cell(1,40);
All_data_Results_1_20 = cell(1,40);


m_2_1=0;  
m_2_2=0;    
m_2_3=0;  
m_2_4=0;  
m_2_5=0;  
m_2_6=0; 
m_2_7=0;  
m_2_8=0;  
m_2_9=0;
m_2_10=0;
m_2_11=0;  
m_2_12=0;    
m_2_13=0;  
m_2_14=0;  
m_2_15=0;  
m_2_16=0; 
m_2_17=0;  
m_2_18=0;  
m_2_19=0;
m_2_20=0;
All_data_Results_2_1 = cell(1,40);
All_data_Results_2_2 = cell(1,40);
All_data_Results_2_3 = cell(1,40);
All_data_Results_2_4 = cell(1,40);
All_data_Results_2_5 = cell(1,40);
All_data_Results_2_6 = cell(1,40);
All_data_Results_2_7 = cell(1,40);
All_data_Results_2_8 = cell(1,40);
All_data_Results_2_9 = cell(1,40);
All_data_Results_2_10 = cell(1,40);
All_data_Results_2_11 = cell(1,40);
All_data_Results_2_12 = cell(1,40);
All_data_Results_2_13 = cell(1,40);
All_data_Results_2_14 = cell(1,40);
All_data_Results_2_15 = cell(1,40);
All_data_Results_2_16 = cell(1,40);
All_data_Results_2_17 = cell(1,40);
All_data_Results_2_18 = cell(1,40);
All_data_Results_2_19 = cell(1,40);
All_data_Results_2_20 = cell(1,40);

m_3_1=0;  
m_3_2=0;    
m_3_3=0;  
m_3_4=0;  
m_3_5=0;  
m_3_6=0; 
m_3_7=0;  
m_3_8=0;  
m_3_9=0;
m_3_10=0;
m_3_11=0;  
m_3_12=0;    
m_3_13=0;  
m_3_14=0;  
m_3_15=0;  
m_3_16=0; 
m_3_17=0;  
m_3_18=0;  
m_3_19=0;
m_3_20=0;
All_data_Results_3_1 = cell(1,40);
All_data_Results_3_2 = cell(1,40);
All_data_Results_3_3 = cell(1,40);
All_data_Results_3_4 = cell(1,40);
All_data_Results_3_5 = cell(1,40);
All_data_Results_3_6 = cell(1,40);
All_data_Results_3_7 = cell(1,40);
All_data_Results_3_8 = cell(1,40);
All_data_Results_3_9 = cell(1,40);
All_data_Results_3_10 = cell(1,40);
All_data_Results_3_11 = cell(1,40);
All_data_Results_3_12 = cell(1,40);
All_data_Results_3_13 = cell(1,40);
All_data_Results_3_14 = cell(1,40);
All_data_Results_3_15 = cell(1,40);
All_data_Results_3_16 = cell(1,40);
All_data_Results_3_17 = cell(1,40);
All_data_Results_3_18 = cell(1,40);
All_data_Results_3_19 = cell(1,40);
All_data_Results_3_20 = cell(1,40);

m_4_1=0;  
m_4_2=0;    
m_4_3=0;  
m_4_4=0;  
m_4_5=0;  
m_4_6=0; 
m_4_7=0;  
m_4_8=0;  
m_4_9=0;
m_4_10=0;
m_4_11=0;  
m_4_12=0;    
m_4_13=0;  
m_4_14=0;  
m_4_15=0;  
m_4_16=0; 
m_4_17=0;  
m_4_18=0;  
m_4_19=0;
m_4_20=0;
All_data_Results_4_1 = cell(1,40);
All_data_Results_4_2 = cell(1,40);
All_data_Results_4_3 = cell(1,40);
All_data_Results_4_4 = cell(1,40);
All_data_Results_4_5 = cell(1,40);
All_data_Results_4_6 = cell(1,40);
All_data_Results_4_7 = cell(1,40);
All_data_Results_4_8 = cell(1,40);
All_data_Results_4_9 = cell(1,40);
All_data_Results_4_10 = cell(1,40);
All_data_Results_4_11 = cell(1,40);
All_data_Results_4_12 = cell(1,40);
All_data_Results_4_13 = cell(1,40);
All_data_Results_4_14 = cell(1,40);
All_data_Results_4_15 = cell(1,40);
All_data_Results_4_16 = cell(1,40);
All_data_Results_4_17 = cell(1,40);
All_data_Results_4_18 = cell(1,40);
All_data_Results_4_19 = cell(1,40);
All_data_Results_4_20 = cell(1,40);



m_5_1=0;  
m_5_2=0;    
m_5_3=0;  
m_5_4=0;  
m_5_5=0;  
m_5_6=0; 
m_5_7=0;  
m_5_8=0;  
m_5_9=0;
m_5_10=0;
m_5_11=0;  
m_5_12=0;    
m_5_13=0;  
m_5_14=0;  
m_5_15=0;  
m_5_16=0; 
m_5_17=0;  
m_5_18=0;  
m_5_19=0;
m_5_20=0;
All_data_Results_5_1 = cell(1,40);
All_data_Results_5_2 = cell(1,40);
All_data_Results_5_3 = cell(1,40);
All_data_Results_5_4 = cell(1,40);
All_data_Results_5_5 = cell(1,40);
All_data_Results_5_6 = cell(1,40);
All_data_Results_5_7 = cell(1,40);
All_data_Results_5_8 = cell(1,40);
All_data_Results_5_9 = cell(1,40);
All_data_Results_5_10 = cell(1,40);
All_data_Results_5_11 = cell(1,40);
All_data_Results_5_12 = cell(1,40);
All_data_Results_5_13 = cell(1,40);
All_data_Results_5_14 = cell(1,40);
All_data_Results_5_15 = cell(1,40);
All_data_Results_5_16 = cell(1,40);
All_data_Results_5_17 = cell(1,40);
All_data_Results_5_18 = cell(1,40);
All_data_Results_5_19 = cell(1,40);
All_data_Results_5_20 = cell(1,40);






for i =1 :15
    
ImageNum =i;

switch ImageNum
            case 1
                filename = 'Barbara';
            case 2
                filename = 'boats';
            case 3
                filename = 'cameraman';
            case 4
                filename = 'couple';    
            case 5
                filename = 'Fence'; 
                
            case 6
                filename = 'flower';
            case 7
                filename = 'House';
            case 8
                filename = 'Leaves';
            case 9
                filename = 'lena';    
            case 10
                filename = 'lin'; 
                
            case 11
                filename = 'Monarch';
            case 12
                filename = 'pentagon';
            case 13
                filename = 'plants';     
                
            case 14
                filename = 'starfish';
            case 15
                filename = 'straw';
       
end
for m  =   1:11
    
  
filename
%miss
JPEG_Quality_Num            = [ 1, 5, 10, 20, 30, 40, 50, 60, 70, 80, 90];



JPEG_Quality            =      JPEG_Quality_Num (m)


   QF   =   0.25;




if JPEG_Quality<= 1
    
     lambda  =   1;
     c  =  1.9;
     p  =  0.45 ;
     Err_or  = 0.00096;
     
elseif JPEG_Quality<= 5  
    
     lambda  =   1;
     c  =  1.6;
     p  =  0.45;
     
     Err_or  = 0.0005;     

elseif JPEG_Quality<= 10  
         
     lambda  =   1;
     c  =  2;
     
     p   =  0.45;
     
      Err_or  = 0.0004;    
     
elseif JPEG_Quality<= 20  
         
     lambda  =   0.9;
     c  =  1.8;
     p  = 0.7;
     
     Err_or  = 0.00019;
     
elseif JPEG_Quality<= 30  
    
     lambda  =   0.9;
     c  =  1.5;
     
     p    =  0.85;
     Err_or  = 0.0010;
     
else
    
     lambda  =   1;
     
     c  =  1;
     
     p   = 0.9;
     
      Err_or  = 0.00014;    
     
end




if JPEG_Quality== 1
   
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);

m_1= m_1+1;
s=strcat('A',num2str(m_1)); 
All_data_Results_1{m_1}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};

xlswrite('NSSRC_MQ_1_Final.xls', All_data_Results_1{m_1},'sheet1',s);

elseif JPEG_Quality== 5
    
 
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_1_1= m_1_1+1;
s=strcat('A',num2str(m_1_1)); 
All_data_Results_1_1{m_1_1}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_5_Final.xls', All_data_Results_1_1{m_1_1},'sheet1',s);


    
elseif JPEG_Quality== 10
    
  
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_2_1= m_2_1+1;
s=strcat('A',num2str(m_2_1)); 
All_data_Results_2_1{m_2_1}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_10_Final.xls', All_data_Results_2_1{m_2_1},'sheet1',s);

    
    
elseif JPEG_Quality== 20
    
 
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_3_1= m_3_1+1;
s=strcat('A',num2str(m_3_1)); 
All_data_Results_3_1{m_3_1}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_20_Final.xls', All_data_Results_3_1{m_3_1},'sheet1',s);

    

elseif JPEG_Quality== 30
 
    
   
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_4_1= m_4_1+1;
s=strcat('A',num2str(m_4_1)); 
All_data_Results_4_1{m_4_1}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_30_Final.xls', All_data_Results_4_1{m_4_1},'sheet1',s);


elseif JPEG_Quality== 40
    
 
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_5_1= m_5_1+1;
s=strcat('A',num2str(m_5_1)); 
All_data_Results_5_1{m_5_1}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_40_Final.xls', All_data_Results_5_1{m_5_1},'sheet1',s);



elseif JPEG_Quality== 50
    
 
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_5_2= m_5_2+1;
s=strcat('A',num2str(m_5_2)); 
All_data_Results_5_2{m_5_2}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_50_Final.xls', All_data_Results_5_2{m_5_2},'sheet1',s);


elseif JPEG_Quality== 60
    
 
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_5_3= m_5_3+1;
s=strcat('A',num2str(m_5_3)); 
All_data_Results_5_3{m_5_3}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_60_Final.xls', All_data_Results_5_3{m_5_3},'sheet1',s);


elseif JPEG_Quality== 70
    
 
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_5_4= m_5_4+1;
s=strcat('A',num2str(m_5_4)); 
All_data_Results_5_4{m_5_4}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_70_Final.xls', All_data_Results_5_4{m_5_4},'sheet1',s);


elseif JPEG_Quality== 80
    
 
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_5_5= m_5_5+1;
s=strcat('A',num2str(m_5_5)); 
All_data_Results_5_5{m_5_5}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_80_Final.xls', All_data_Results_5_5{m_5_5},'sheet1',s);


else
    
    
[filename, JPEG_Quality,   lambda, c,  JPEG_PSNR, PSNR_Final,FSIM_Final,SSIM_Final, diff, Time_s]     =  NSSRC_Deblock_Test (filename, JPEG_Quality,  lambda, c, p, QF,Err_or);                                                              
m_5_6= m_5_6+1;
s=strcat('A',num2str(m_5_6)); 
All_data_Results_5_6{m_5_6}={filename, JPEG_Quality, PSNR_Final, FSIM_Final,SSIM_Final, Time_s};
xlswrite('NSSRC_MQ_90_Final.xls', All_data_Results_5_6{m_5_6},'sheet1',s);





      
end


clearvars -except filename i m_1 All_data_Results_1 m_2 All_data_Results_2 ...
m_3 All_data_Results_3 m_4 All_data_Results_4 m_5 All_data_Results_5...
m_6 All_data_Results_6 m_7 All_data_Results_7 m_8 All_data_Results_8 m_9 All_data_Results_9 ...
m_10 All_data_Results_10 m_11 All_data_Results_11 m_12 All_data_Results_12 m_13 All_data_Results_13 ...
m_14 All_data_Results_14 m_15 All_data_Results_15 m_16 All_data_Results_16 m_17 All_data_Results_17 m_18 All_data_Results_18 ...
m_19 All_data_Results_19 m_20 All_data_Results_20...
m_1_1 All_data_Results_1_1 m_1_2 All_data_Results_1_2 ...
m_1_3 All_data_Results_1_3 m_1_4 All_data_Results_1_4 m_1_5 All_data_Results_1_5...
m_1_6 All_data_Results_1_6 m_1_7 All_data_Results_1_7 m_1_8 All_data_Results_1_8 m_1_9 All_data_Results_1_9 ...
m_1_10 All_data_Results_1_10 m_1_11 All_data_Results_1_11 m_1_12 All_data_Results_1_12 m_1_13 All_data_Results_1_13 ...
m_1_14 All_data_Results_1_14 m_1_15 All_data_Results_1_15 m_1_16 All_data_Results_1_16 m_1_17 All_data_Results_1_17 m_1_18 All_data_Results_1_18 ...
m_1_19 All_data_Results_1_19 m_1_20 All_data_Results_1_20...
m_2_1 All_data_Results_2_1 m_2_2 All_data_Results_2_2 ...
m_2_3 All_data_Results_2_3 m_2_4 All_data_Results_2_4 m_2_5 All_data_Results_2_5...
m_2_6 All_data_Results_2_6 m_2_7 All_data_Results_2_7 m_2_8 All_data_Results_2_8 m_2_9 All_data_Results_2_9 ...
m_2_10 All_data_Results_2_10 m_2_11 All_data_Results_2_11 m_2_12 All_data_Results_2_12 m_2_13 All_data_Results_2_13 ...
m_2_14 All_data_Results_2_14 m_2_15 All_data_Results_2_15 m_2_16 All_data_Results_2_16 m_2_17 All_data_Results_2_17 m_2_18 All_data_Results_2_18 ...
m_2_19 All_data_Results_2_19 m_2_20 All_data_Results_2_20...
m_3_1 All_data_Results_3_1 m_3_2 All_data_Results_3_2 ...
m_3_3 All_data_Results_3_3 m_3_4 All_data_Results_3_4 m_3_5 All_data_Results_3_5...
m_3_6 All_data_Results_3_6 m_3_7 All_data_Results_3_7 m_3_8 All_data_Results_3_8 m_3_9 All_data_Results_3_9 ...
m_3_10 All_data_Results_3_10 m_3_11 All_data_Results_3_11 m_3_12 All_data_Results_3_12 m_3_13 All_data_Results_3_13 ...
m_3_14 All_data_Results_3_14 m_3_15 All_data_Results_3_15 m_3_16 All_data_Results_3_16 m_3_17 All_data_Results_3_17 m_3_18 All_data_Results_3_18 ...
m_3_19 All_data_Results_3_19 m_3_20 All_data_Results_3_20...
m_4_1 All_data_Results_4_1 m_4_2 All_data_Results_4_2 ...
m_4_3 All_data_Results_4_3 m_4_4 All_data_Results_4_4 m_4_5 All_data_Results_4_5...
m_4_6 All_data_Results_4_6 m_4_7 All_data_Results_4_7 m_4_8 All_data_Results_4_8 m_4_9 All_data_Results_4_9 ...
m_4_10 All_data_Results_4_10 m_4_11 All_data_Results_4_11 m_4_12 All_data_Results_4_12 m_4_13 All_data_Results_4_13 ...
m_4_14 All_data_Results_4_14 m_4_15 All_data_Results_4_15 m_4_16 All_data_Results_4_16 m_4_17 All_data_Results_4_17 m_4_18 All_data_Results_4_18 ...
m_4_19 All_data_Results_4_19 m_4_20 All_data_Results_4_20...
m_5_1 All_data_Results_5_1 m_5_2 All_data_Results_5_2 ...
m_5_3 All_data_Results_5_3 m_5_4 All_data_Results_5_4 m_5_5 All_data_Results_5_5...
m_5_6 All_data_Results_5_6 m_5_7 All_data_Results_5_7 m_5_8 All_data_Results_5_8 m_5_9 All_data_Results_5_9 ...
m_5_10 All_data_Results_5_10 m_5_11 All_data_Results_5_11 m_5_12 All_data_Results_5_12 m_5_13 All_data_Results_5_13 ...
m_5_14 All_data_Results_5_14 m_5_15 All_data_Results_5_15 m_5_16 All_data_Results_5_16 m_5_17 All_data_Results_5_17 m_5_18 All_data_Results_5_18 ...
m_5_19 All_data_Results_5_19 m_5_20 All_data_Results_5_20




end
clc
%clear
end





         